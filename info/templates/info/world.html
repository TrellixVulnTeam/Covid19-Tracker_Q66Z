{% extends 'info/base.html' %}

{% load static %}

{% block title %}
<title>World | Covid19</title>
{% endblock title %}

{% block content %}
<div class="container-fluid">

    <!-- Table -->
    <div class="col-lg-3 col-md-6 col-sm-12 col-xs-12">
        <div class="panel card-view">
            <div class="panel-heading small-panel-heading relative">
                <div class="pull-left">
                    <i class="zmdi zmdi-google-earth mr-10"></i>
                    <h6 style="margin:22px 0 0 12px;display:inline-block;font-size:30px; font-weight: 700;"
                        class="panel-title">
                        Worldwide Data </h6>


                </div>
                <div class="clearfix"></div>

                <div class="head-overlay"></div>

            </div>
            <div class="panel-wrapper collapse in">
                <div class="panel-body row pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-xs-12 pt-0 pl-4 pr-0 data-wrap-left">
                                    <p>Affected Province/State : <span class="counter-anim">{{country_count}}</span> </p>

                                </div>
                                <!-- <div class=" col-xs-6 text-center pl-0 pr-0 pt-0 data-wrap-right">


                                            </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default card-view pa-0">
            <div class="panel-wrapper collapse in">

                <div class="panel-body pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row ">

                                <div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left ">
                                    <span class="txt-dark block counter"><span
                                            class="counter-anim text-danger">{{confirmed_total}}</span></span>
                                    <span class="weight-500 capitalize-font block font-13">Total Confirmed
                                        Cases</span>
                                </div>
                                <div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
                                    <i class="icon-control-rewind data-right-rep-icon txt-light-grey"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default card-view pa-0">
            <div class="panel-wrapper collapse in">

                <div class="panel-body pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row ">

                                <div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left ">
                                    <span class="txt-dark block counter"><span
                                            class="counter-anim text-danger">{{deaths_total}}</span></span>
                                    <span class="weight-500 capitalize-font block font-13">Total Death
                                        Cases</span>
                                </div>
                                <div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
                                    <i class="icon-control-rewind data-right-rep-icon txt-light-grey"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default card-view pa-0">
            <div class="panel-wrapper collapse in">
                <div class="panel-body pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left">
                                    <span class="txt-dark block counter"><span
                                            class="counter-anim text-success">{{recovered_total}}</span></span>
                                    <span class="weight-500 capitalize-font font-13 block">Total Recovery
                                        Cases</span>
                                </div>
                                <div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
                                    <i class="icon-user-following data-right-rep-icon txt-light-grey"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default card-view pa-0">
            <div class="panel-wrapper collapse in">

                <div class="panel-body pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row ">

                                <div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left ">
                                    <span class="txt-dark block counter"><span
                                            class="counter-anim text-danger">{{ mortality_rate }}</span></span>
                                    <span class="weight-500 capitalize-font block font-13">Mortality rate</span>
                                </div>
                                <div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
                                    <i class="icon-control-rewind data-right-rep-icon txt-light-grey"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default card-view pa-0">
            <div class="panel-wrapper collapse in">

                <div class="panel-body pa-0">
                    <div class="sm-data-box">
                        <div class="container-fluid">
                            <div class="row ">
                                <div class="col-xs-6 text-center pl-0 pr-0 data-wrap-left ">
                                    <span class="txt-dark block counter"><span
                                            class="counter-anim text-success">{{ recovery_rate }}</span></span>
                                    <span class="weight-500 capitalize-font block font-13">Recovery rate</span>
                                </div>
                                <div class="col-xs-6 text-center  pl-0 pr-0 data-wrap-right">
                                    <i class="icon-control-rewind data-right-rep-icon txt-light-grey"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="col-lg-9 col-md-6 col-sm-12 col-xs-12">
        <div class=" panel panel-default card-view">
            <div class="panel-heading text-center">
                <div class="pull-left">
                    <h6 class="panel-title txt-dark">World Map</h6>
                </div>



                <span id="typed" style="font-weight: 500;font-size:17px;display: inline;"></span>

                <div class=" pull-right">

                    <a href="#" class="pull-left inline-block full-screen">
                        <i class="zmdi zmdi-fullscreen"></i>
                    </a>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="panel-wrapper collapse in">
                <div class="panel-body">
                    <div width="400" height="200">{{ iframe|safe }}</div>
                </div>
            </div>
        </div>
    </div>


    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class=" panel panel-default card-view">
            <div class="panel-heading text-center">
                <div class="pull-left">
                    <h6 class="panel-title txt-dark">Increment Graph</h6>
                </div>



                <span id="typed" style="font-weight: 500;font-size:17px;display: inline;"></span>

                <div class=" pull-right">

                    <a href="#" class="pull-left inline-block full-screen">
                        <i class="zmdi zmdi-fullscreen"></i>
                    </a>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="panel-wrapper collapse in">
                <div class="panel-body">

                    <canvas id="myChart" width="400" height="200"></canvas>

                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class=" panel panel-default card-view">
            <div class="panel-heading text-center">
                <div class="pull-left">
                    <h6 class="panel-title txt-dark">COVID-19: Progression of spread</h6>
                </div>



                <span id="typed" style="font-weight: 500;font-size:17px;display: inline;"></span>

                <div class=" pull-right">

                    <a href="#" class="pull-left inline-block full-screen">
                        <i class="zmdi zmdi-fullscreen"></i>
                    </a>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="panel-wrapper collapse in">
                <div class="panel-body">

                    <iframe width="800" height="400" frameborder="0" scrolling="no" src="{{fig}}"></iframe>

                </div>
            </div>
        </div>
    </div>
</div>


<div class="container-fluid">

    <!-- Table -->
    <div class="row heading-bg">
        <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
            <h5 class="txt-dark">Worldwide Data</h5>
        </div>
    </div>

    <!-- Row -->
    <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default card-view">
                <div class="panel-wrapper collapse in">
                    <div class="panel-body">
                        <div class="table-wrap">
                            <div class="table-responsive">
                                <table id="example" class="table table-hover display  pb-30">
                                    <thead>
                                        <tr>
                                            <th>Country</th>
                                            <th>Number of Cases</th>
                                            <th>Death counts</th>
                                            <th>Number of Recovered</th>


                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                            <th>Country</th>
                                            <th>Number of Cases</th>
                                            <th>Death counts</th>
                                            <th>Number of Recovered</th>

                                        </tr>
                                    </tfoot>
                                    <tbody>

                                        {% for i in world.all_countries|dictsortreversed:"latest_data.deaths"%}
                                        <tr>
                                            <td>{{i.name}}</td>
                                            <td>{{i.latest_data.confirmed}}</td>
                                            <td>{{i.latest_data.deaths}}</td>
                                            <td>{{i.latest_data.recovered}}</td>
                                            <!-- <td></td> -->
                                        </tr>
                                        {% endfor %}

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock content %}


{% block js %}
<script>
    var date = [];
    var deaths = [];
    var confirmed = [];
    var recovered = [];

    '{%for dates in dates%}'
    date.push("{{dates}}");
    '{% endfor %}'

    '{%for deaths in deaths%}'
    deaths.push(parseInt('{{deaths}}'));
    '{% endfor %}'

    '{%for recovered in recovered%}'
    recovered.push(parseInt('{{recovered}}'));
    '{% endfor %}'

    '{%for confirmed in confirmed%}'
    confirmed.push(parseInt('{{confirmed}}'));
    '{% endfor %}'


	var ctx = document.getElementById('myChart').getContext('2d');
	var myChart = new Chart(ctx, {
		type: 'line',
		data: {

			labels: date.reverse(),
			datasets: [
				{
					label: 'Number of deaths',
					data: deaths.reverse(),
					backgroundColor: "#ffe0ac",
                    borderWidth: 1,
                    fill:true


                },
                {
					label: 'Number of recovered',
					data: recovered.reverse(),
					backgroundColor: "#6886c5",

                    borderWidth: 1,
                    fill:true


                },
                {
					label: 'Number of cases',
					data: confirmed.reverse(),
                    backgroundColor: "#ffacb7",
                    borderWidth: 1,
                    fill:true
				},
			]
		},
		options: {
            tooltips: {
      mode: 'index',
      intersect: true
    },
			scales: {
				yAxes: [{
					ticks: {
						beginAtZero: true
					}
				}]
            }

		}
    });

$(document).ready(function () {
			setTimeout(300)
			var options = {
				strings: ['  For your Health', 'for the people you love', 'for your country',
					"There's something you can do^3000 ",
					'Stay Home!^5000'

				],

				typeSpeed: 40,
				backSpeed: 50,
				smartBackspace: true,
				startDelay: 7000,
				// loop: true,
				// loopCount: 2,
				onComplete: function (self) {
					self.cursor.remove()
				}


			};

			var typed = new Typed('#typed', options)



		});
    </script>
{% endblock js %}
